<!DOCTYPE html>
<html>
<head>
  <!-- Add Firebase SDK script tags -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.21.0/firebase.js"></script>

  <title>Hotel Request Form</title>
  <style>
    /* CSS styles for form layout */
/* CSS styles for form layout */
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 20px;
  background-color: #f3f0e7;
}

img {
  max-width: 60%;
  height: auto;
  display: block;
  margin-left: auto;
  margin-right: auto;
  margin-top: 12%;
}

.navbar {
  background-color: rgba(58, 153, 174, 1);
  padding: 30px;
  text-align: center;
  color: white;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  margin: 0;
  font-size: 50px;
}

#invoiceWrapper {
  background-color: #fff;
  padding: 1em;
  margin-bottom: 1em;
}

h1 {
  color: #333;
  font-size: 44px;
  text-align: center;
  text-decoration: dashed;
  margin-top: 0; /* Remove the default top margin */
}

h3 {
  font-size: 20px;
  font-weight: bold;
  margin-top: 2em;
  margin-bottom: 0.5em;
}

form {
  max-width: 650px;
  margin: 0 auto;
  padding: 20px;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

form label {
  margin-bottom: 8px;
  margin-left: 8px;
  font-weight: bold;
}

form input[type='text'],
form input[type='number'],
form input[type='date'],
form select,
form textarea {
  width: 20%;
  padding: 10px;
  margin-bottom: 12px;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: 16px;
}

form .nice-form-group {
  margin-bottom: 20px;
}

form h2.form-section {
  color: #333;
  font-size: 20px;
  margin-top: 24px;
  margin-bottom: 1px;
}

form .roomCount {
  width: 80px;
}

form .guestCheckbox {
  margin-right: 8px;
}

form #invoice p {
  margin: 8px 0;
}

.colorButton{
  display: block;
  width: 100%;
  padding: 12px;
  background-color: #4CAF50;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
}
.greyButton {
  background-color: grey;
  display: block;
  width: 100%;
  padding: 12px;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
}


.colorButton:hover {
  background-color: #45a049;
}

/* Responsive styles */
@media screen and (max-width: 600px) {
  form {
    padding: 10px;
  }

  form input[type='text'],
  form input[type='number'],
  form input[type='date'],
  form select,
  form textarea {
    font-size: 14px;
  }

  form h2.form-section {
    font-size: 18px;
  }

  form button[type='submit'] {
    font-size: 14px;
  }
}


/* Add your custom styles here */

input[type='checkbox'] {
  /* display: none; */
  width: 20px;
  height: 20px;
  border: 2px solid #ccc;
  border-radius: 4px;
  margin-right: 2px;
  margin-left: 6px;
  outline: none;
  cursor: pointer;
  transition: background-color 0.3s ease;
}


  </style>
</head>
<body>
  <div class="navbar">
    Vibrant Diwali Jhalod 2023
  </div>
  <img src="logo.png" alt="VDJ2023_logo">

  <h1>Hotel Request Form</h1>
  <form id="registrationForm">
    <input type="hidden" name="dynamicFields" id="dynamicFieldsInput">

    <br>
    <label for="guestCount">Number of Guests:</label>
    <input type="number" id="guestCount" min="1" required>

    <label for="roomCount">Number of Rooms:</label>
    <input type="number" id="roomCount" min="1" required>
    
    <br>
    <div id="guestDetails">
      <!-- Guest names and year of birth input fields will be dynamically generated here -->
    </div>

    <label>E-mail: </label><input type="email" name="email" id="email" required>
<label>Phone: </label><input type="tel" name="phone" id="phone" required>

    <br><br>
    <label for="arrivalDate">Arrival Date:</label>
<input type="date" id="arrivalDate" min="2023-11-10" max="2023-11-15" required>
<label for="departureDate">Departure Date:</label>
<input type="date" id="departureDate" min="2023-11-10" max="2023-11-15" required>



    
    <h2>Select Room Allocation:</h2>
    <p>Please fill in the information for each day (Number of rooms needed on that day & tick the people who would be staying)</p>
    <div id="roomAllocation">
      <!-- <input type="checkbox" /><label>Trial</label> -->
      <!-- Room allocation for each day will be dynamically generated here -->
    </div>
    
    <br>
    <h2>Select Hotel:</h2>
    <div id="hotelOptions">
      <!-- Hotel options with prices will be dynamically generated here -->
    </div>
    
    <br>
    <div id="invoiceWrapper">
    <h2>Invoice:</h2>
    <div id="invoice">
      <!-- Invoice details will be dynamically generated here -->
    </div>
  </div>

  <h2>Payment Options:</h2>
<input type="radio" name="paymentOption" id="paymentOption" value="upi" checked>
<label for="upiOption">UPI</label>
<input type="radio" name="paymentOption" id="paymentOption" value="bank">
<label for="bankOption">Bank Transfer</label>

<div id="upiDetails" style="display: block;">
  <h3>UPI Details:</h3>
  <!-- Add UPI details and transaction field input -->
  <p>Name: SHREE DASHANIMA VANIK SAMAJ</p>
  <p>UPI-ID: shreedashanimavaniks.62689508@okhdfcbank</p>
  <label style="width: 40%;">UPI Transaction Id: </label>
</div>

<div id="bankDetails" style="display: none;">
  <h3>Bank Details:</h3>
  <p>Name : SHREE DASHANIMA VANIK SAMAJ</p>
    <p>Account No : 50200076443991</p>
    <p>IFSC CODE : HDFC0005644</p>
    <p>SWIFT CODE: HDFCINBBXXX</p>
  <!-- Add bank details and transaction field input -->
  <label>Bank Transaction Id: </label>
</div>
<input type="text" name="transactionId" id="transactionId" placeholder="Transaction Id here" required>

    <br>
    <label for="consent">I accept the terms and conditions:</label>
    <p style="margin-left: 15px; color: rgb(132, 3, 3);">I hereby confirm that the above-mentioned information is correctly filled, and I have read and understood all the instructions mentioned in the form.</p>
    <label>Yes, I consent</label>
    <input type="checkbox" id="consent" required>
    <br><br><br>
    <button type="submit" id="submitButton" disabled class="greyButton">Submit</button>


  </form>

  <script>
  // JavaScript code for form functionality
    // Add your custom JavaScript code here

    // Dynamically generate guest name and year of birth input fields based on the number of guests
    document.getElementById("guestCount").addEventListener("input", function() {
      var guestCount = parseInt(this.value);
      var guestDetails = document.getElementById("guestDetails");
      guestDetails.innerHTML = ""; // Clear existing fields

      for (var i = 1; i <= guestCount; i++) {
        var guestDiv = document.createElement("div");
        guestDiv.innerHTML = `
          <label for="guestName${i}">Guest Name ${i}:</label>
          <input type="text" id="guestName${i}" required>
          <label for="guestYearOfBirth${i}">Year of Birth:</label>
          <input type="number" id="guestYearOfBirth${i}" min="1950" max="2023" required">
          <span id="yearOfBirthError" style="color: red; display: none;">Please enter a valid year of birth (between 1950 and 2023).</span>

        `;
        guestDetails.appendChild(guestDiv);
      }
    });

    

    // Generate room allocation options for each day
    document.getElementById("arrivalDate").addEventListener("input", generateRoomAllocation);
    document.getElementById("departureDate").addEventListener("input", generateRoomAllocation);

    function generateRoomAllocation() {
      var arrivalDate = new Date(document.getElementById("arrivalDate").value);
      var departureDate = new Date(document.getElementById("departureDate").value);
      var roomAllocation = document.getElementById("roomAllocation");
      roomAllocation.innerHTML = ""; // Clear existing fields

      

      var date = new Date(arrivalDate);
      while (date <= departureDate) {
        var formattedDate = date.toLocaleDateString("en-US", { day: "numeric", month: "long", year: "numeric" });
        var roomDiv = document.createElement("div");
        roomDiv.innerHTML = `
          <h3>${formattedDate}</h3>
          <label for="roomCount${formattedDate}">Number of Rooms:</label>
          <input type="number" id="roomCount${formattedDate}" min="0" class="roomCount" required><br>
          <label for="guestCheckboxes${formattedDate}">Guests:</label>
          <div id="guestCheckboxes${formattedDate}">
          </div>
        `;
        roomAllocation.appendChild(roomDiv);
        date.setDate(date.getDate() + 1); // Increment date by 1 day
      }
    }


      
    
    // // clear existing guest checkboxes
    // var guestCheckboxes = roomAllocation.querySelectorAll("[id^='guestCheckboxes']");
    //   guestCheckboxes.forEach(function (element) {
    //     element.innerHTML = "";
    //   });

    // Generate guest checkboxes for room allocation
document.getElementById("registrationForm").addEventListener("input", generateGuestCheckboxes);
function generateGuestCheckboxes() {
  var guestCount = parseInt(document.getElementById("guestCount").value);
  var roomAllocation = document.getElementById("roomAllocation");

  // Generate guest checkboxes for each day
  var arrivalDate = new Date(document.getElementById("arrivalDate").value);
  var departureDate = new Date(document.getElementById("departureDate").value);
  var date = new Date(arrivalDate);
  while (date <= departureDate) {
    var formattedDate = date.toLocaleDateString("en-US", { day: "numeric", month: "long", year: "numeric" });
    var guestCheckboxesDiv = document.getElementById("guestCheckboxes" + formattedDate);

    // Store the current checkbox values
    var currentCheckboxValues = {};
    guestCheckboxesDiv.querySelectorAll('input[type="checkbox"]').forEach(function(checkbox) {
      currentCheckboxValues[checkbox.id] = checkbox.checked;
    });

    // Clear existing guest checkboxes for the specific date
    guestCheckboxesDiv.innerHTML = "";

    for (var i = 1; i <= guestCount; i++) {
      var guestName = document.getElementById("guestName" + i).value;
      var guestCheckbox = document.createElement("input");
      guestCheckbox.type = "checkbox";
      guestCheckbox.name = "guestCheckbox" + formattedDate;
      guestCheckbox.id = "guestCheckbox" + formattedDate + "_" + i;
      guestCheckbox.value = guestName;
      guestCheckbox.classList.add("guestCheckbox");

      // Set the checked state based on the stored values
      if (currentCheckboxValues[guestCheckbox.id]) {
        guestCheckbox.checked = true;
      }

      var guestLabel = document.createElement("label");
      guestLabel.htmlFor = "guestCheckbox" + formattedDate + "_" + i;
      guestLabel.textContent = guestName;

      guestCheckboxesDiv.appendChild(guestCheckbox);
      guestCheckboxesDiv.appendChild(guestLabel);
    }

    date.setDate(date.getDate() + 1); // Increment date by 1 day
  }
}
// Generate hotel options
document.getElementById("roomCount").addEventListener("input", generateHotelOptions);
document.getElementById("guestCount").addEventListener("input", generateHotelOptions); // Add this line

function generateHotelOptions() {
  var roomCount = parseInt(document.getElementById("roomCount").value);
  var guestCount = parseInt(document.getElementById("guestCount").value); // Add this line
  var hotelOptions = document.getElementById("hotelOptions");
  hotelOptions.innerHTML = ""; // Clear existing options

  // Define the hotel options with prices
  var hotels = [
    { name: "Goyal Palace", price: 3000 },
    { name: "Prabhuta Party Plot", price: 2500 },
    { name: "Kamdhenu Hotel", price: 2500 },
    { name: "Limdi", price: 2500 },
    { name: "Central Plaza", price: 2000 },
    { name: "Hotel Tribhuvan", price: 2000 }
  ];

  hotels.forEach(function(hotel) {
    var hotelDiv = document.createElement("div");
    hotelDiv.innerHTML = `
      <input type="radio" name="hotelOption" id="hotelOption${hotel.name}" value="${hotel.name}:${hotel.price}">
      <label for="hotelOption${hotel.name}">${hotel.name} - ₹${hotel.price} per night</label>
    `;
    hotelOptions.appendChild(hotelDiv);
  });
}



  // Generate invoice
document.getElementById("registrationForm").addEventListener("input", generateInvoice);
function generateInvoice() {
  var selectedHotel = document.querySelector('input[name="hotelOption"]:checked');
  var roomAllocation = document.querySelectorAll(".roomCount");
  var invoice = document.getElementById("invoice");
  var totalPrice = 0;

  roomAllocation.forEach(function(room) {
    var roomCount = parseInt(room.value);
    if (selectedHotel && selectedHotel.value) {
  totalPrice += roomCount * parseInt(selectedHotel.value.split(":")[1]);
} else {
  // Handle the case when selectedHotel is null or undefined
}
  });

  if (selectedHotel) {
    var hotelName = selectedHotel.value.split(":")[0];
    invoice.innerHTML = `
      <p>Selected Hotel: ${hotelName}</p>
      <p>Total Price: ₹${totalPrice}</p>
      <p>10% Advance Payment: ₹${totalPrice * 0.1}</p>
    `;
  } else {
    invoice.innerHTML = ""; // Clear invoice if no hotel is selected
  }
}

// Add event listener for payment option change
document.querySelectorAll('input[name="paymentOption"]').forEach(function(option) {
  option.addEventListener('change', handlePaymentOptionChange);
});

// Handle payment option change
function handlePaymentOptionChange() {
  var selectedOption = document.querySelector('input[name="paymentOption"]:checked').value;
  var upiDetails = document.getElementById('upiDetails');
  var bankDetails = document.getElementById('bankDetails');

  // Show/hide divs based on selected payment option
  if (selectedOption === 'upi') {
    upiDetails.style.display = 'block';
    bankDetails.style.display = 'none';
  } else if (selectedOption === 'bank') {
    upiDetails.style.display = 'none';
    bankDetails.style.display = 'block';
  }
}



document.getElementById("consent").addEventListener("change", function() {
  var submitButton = document.getElementById("submitButton");
  submitButton.disabled = !this.checked;
  
  if (this.checked) {
    submitButton.classList.remove("greyButton");
    submitButton.classList.add("colorButton");
  } else {
    submitButton.classList.remove("colorButton");
    submitButton.classList.add("greyButton");
  }
});


  

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyC-u-aZXFHKI5jQgL-jUWfl0-qFnd2s8-g",
    authDomain: "hotelrequest-vdj2023.firebaseapp.com",
    databaseURL: "https://hotelrequest-vdj2023-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "hotelrequest-vdj2023",
    storageBucket: "hotelrequest-vdj2023.appspot.com",
    messagingSenderId: "120848277297",
    appId: "1:120848277297:web:ca1172f549bdb7fc8c5a10",
    measurementId: "G-7DLVGBQYTD"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  
  var database = firebase.database().ref('hotelrequest-vdj2023');

  document.getElementById("registrationForm").addEventListener("submit", submitForm);
  function submitForm(e) {
    e.preventDefault();

     var guestCount = getElementValue("guestCount");
  var roomCount = getElementValue("roomCount");
  var email = getElementValue("email");
  var phone = getElementValue("phone");
  var arrivalDate = getElementValue("arrivalDate");
  var departureDate = getElementValue("departureDate");
  var paymentOption = getElementValue("paymentOption");
  var transactionId = getElementValue("transactionId");

  var guestDetails = document.getElementById("guestDetails").querySelectorAll("input[type='text']");
  var roomAllocation = document.getElementById("roomAllocation").querySelectorAll(".roomCount");
  var hotelOption = document.querySelector('input[name="hotelOption"]:checked').value;

  var dynamicFields = [];

// Generate guest information and room allocation for each day
var arrival = new Date(arrivalDate);
var departure = new Date(departureDate);
var date = new Date(arrivalDate);

while (date <= departure) {
  var formattedDate = date.toLocaleDateString("en-US", { day: "numeric", month: "long", year: "numeric" });
  var dateSelector = formattedDate.replace(/\W/g, "");

  var guestCheckboxesDiv = document.getElementById("guestCheckboxes" + formattedDate); // Update ID format

  var guestsChecked = guestCheckboxesDiv.querySelectorAll("input[type='checkbox']:checked");
  var guestsStaying = Array.from(guestsChecked).map(function(checkbox) {
    return checkbox.value;
  });

  var roomIndex = dateDiffInDays(arrival, date);
  dynamicFields.push({
    date: formattedDate,
    rooms: roomAllocation[roomIndex].value,
    guests: guestsStaying
  });

  date.setDate(date.getDate() + 1);
}


  var guestInfo = [];

  guestDetails.forEach(function(field, index) {
    var guestName = field.value;
    var guestYearOfBirth = document.getElementById("guestYearOfBirth" + (index + 1)).value;
    guestInfo.push({
      name: guestName,
      dateOfBirth: guestYearOfBirth
    });
  });

  var formData = database.push();
  formData.set({
    guestCount: guestCount,
    roomCount: roomCount,
    email: email,
    phone: phone,
    arrivalDate: arrivalDate,
    departureDate: departureDate,
    paymentOption: paymentOption,
    transactionId: transactionId,
    guestInfo: guestInfo, 
    planOfStay: dynamicFields, 
    hotelOption: hotelOption
  });

  console.log("Data uploaded to Firebase successfully!");
  // Clear form fields
document.getElementById("registrationForm").reset();
alert("Form submitted successfully!");

// Refresh the page
location.reload();

}
function dateDiffInDays(date1, date2) {
  const timeDiff = Math.abs(date2.getTime() - date1.getTime());
  return Math.ceil(timeDiff / (1000 * 3600 * 24));
}
  const getElementValue = (id) => {
    return document.getElementById(id).value;
  }

  </script>
  

</body>
</html>
